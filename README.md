# **中國文化大學 畢業專題介紹**
利用機台上的鏡頭識別棋盤data，引導data傳回程式演算法電腦判斷下一步，再將結果傳至機械手臂配合鏡頭做出預期動作。  
Client: Google Colab，Python，OpenCV，Dobot  
Hardware:鏡頭＊1，機械手臂＊2，棋盤＊1，電腦＊1  
Panelists:[吳勁緯](https://github.com/wendellgithub0206 "link")，[蔣善澤]( https://github.com/temonmsl "link")  
guiding mentor:[林世崧](https://github.com/pccusslin0629 "link")
## AI下棋機器人之研製
主要分為三部分以及最終整合
* [棋藝主程式]<br/>
  [四子棋](https://github.com/wendellgithub0206/PGP/tree/main/%E5%9B%9B%E5%AD%90%E6%A3%8B "link")
  [五子棋](https://github.com/wendellgithub0206/PGP/tree/main/%E4%BA%94%E5%AD%90%E6%A3%8B "link")
* [影像處理](https://github.com/wendellgithub0206/PGP/tree/main/%E5%BD%B1%E5%83%8F%E8%99%95%E7%90%86 "link")
* [機械手臂](https://github.com/wendellgithub0206/PGP/tree/main/%E6%A9%9F%E6%A2%B0%E6%89%8B%E8%87%82 "link")
## AI

* 強化式學習<br/>
以大量資料為基礎的監督式學習非監督式學習不同，期目的是為了在特定環境中採取適當的動作。比如自動駕駛就是強化式學習的應用。 
強化式學習(Reinforcement learning)是透過代理人(agent)根據環境狀態(environment)採取動作(action)已獲得更多回饋值(reward)的方法，此法與監督非監督式學習不同，在於不依靠訓練資料，只靠代理人本身已試誤法來進行學習。<br/>
![image](https://github.com/wendellgithub0206/PGP/blob/main/%E5%BC%B7%E5%8C%96%E5%BC%8F%E5%AD%B8%E7%BF%92.png)
* 殘差網路(ResNet) <br/>
在神經網路中我們可以透過加深層數來提取更複雜的特徵，但是當神經網路的深度達到某個程度時，訓練資料的準確率會上升然後達到飽和，然後迅速下降，就是光訓練資料的成效就很差。 
殘差網路第一次出現是在2015年的ImageNet影像辨識競賽，已超高準確率獲得當年冠軍。殘差網路就是使用了152層網路結構，超過百層的殘差網路卻不會降低準確率的關鍵在於其特殊的殘差塊(Residual block)結構，設計一條捷徑來讓淺層的網路也能得到較有效果的訓練使得在深度較深的模型在做反向傳播時不會因傳遞太多層而導致梯度嚴重下降，使得我們訓練更深層的神經網路，獲得更好的成果。
![image](https://github.com/wendellgithub0206/PGP/blob/main/%E6%AE%98%E5%B7%AE%E7%B6%B2%E8%B7%AF.png)

## 棋藝演算法
**主要使用以下演算法**  
* 蒙地卡羅樹搜尋（MCTS）<br/>
評估：<br/>
	取得策略以及局是價值，策略用來計算出PUCT中棋步的機率分布，而局是價值則慧用來更新PUCT中的累計價值。<br/>
擴充：<br/>
  	每試驗1次就進行擴充，因為本實驗配合神經網路已預測出棋步會下在哪了。<br/>
更新：<br/>
	取得局勢價值與試驗次數後，在返回跟節點途中，根據該價值進行節點資訊(累計價值及試驗次數)的更新。<br/>
## 影像處理
### 棋盤辨識
棋盤操作分為三個步驟，將任意自訂棋盤從圖片中分割出來：
1. **設定顏色範圍**：根據棋盤的顏色，設定顏色的上限和下限範圍，利用掩模（mask）進行過濾，將不屬於此顏色範圍內的區域排除。
2. **覆蓋不需要的區域**：將屬於顏色範圍內但不是我們所需要的區域進行覆蓋，以避免干擾。
3. **確認並抓取所需區域**：確認所選區域是否為我們需要的正確區域，並將其抓取下來。

### 棋子辨識
辨識棋盤上的棋子，主要辨識黑棋、白棋和無棋子的情況，步驟如下：
1. **二值化圖像**：將圖像進行二值化處理，以便於後續的像素統計和分析。
2. **統計黑色像素**：通過計算二值化圖像中的黑色像素數量來判斷該區域是否有黑棋。特別需要注意的是，由於白棋和無棋子都會在二值化圖像中產生大量的白色區域，因此需要進一步區分。

### 棋局辨識
遍歷每個棋盤格子、計算格子內棋子的顏色和位置，最終返回一個二維列表來表示整個棋盤的狀態。這可以用於後續的棋局分析、棋譜記錄或其他應用。
1. **遍歷格子**：逐個遍歷棋盤的每個格子，提取每個格子的圖像區域。
2. **計算棋子顏色和位置**：使用預先定義的函數（例如 Bgray 和 Wgray）來計算每個格子內的黑棋和白棋指標，根據計算結果判斷該格子中是否有棋子，以及棋子的顏色。
3. **返回棋盤狀態**：將每個格子的狀態（黑棋、白棋、無棋子）記錄在一個二維列表中，最終返回這個二維列表，用於表示整個棋盤的狀態。
## 機械手臂
使用Dobot Magician提供的DobotStudio開發套件能簡單的實做機器人運動之控制。
## Google Colab
Google Colab是一個基於 Jupyter Notebook 的免費CPU虛擬機，透過瀏覽器即可編寫程式，當離開瀏覽器操作畫面，虛擬機上的操作資料都被清空，所以使用者不需要擔心操作不慎搞壞機器。除了資料存至雲端虛擬機上之外，還可以連接Google Drive雲端硬碟，將訓練完成的AI模型或資料科學處理的資料進行儲存，而Google Colab擁有以下幾個特點：<br/>
1不需任何設定：瀏覽器開起Google Colab，連線完成即建立玩虛擬機，就可以使用Google Colab的功能。<br>
2免費使用 GPU或TPU：Colab中可選用的GPU通常包括Nvidia K80，T4，P4和P100，但使用者不能選擇使用哪種類型的GPU，由於免費使用的關係，Colab無法保證資源，會依據時間和使用者有浮動，筆記本最長可執行	12小時；如果一定需要使用GPU，可以選擇升級為付費版本Colab Pro，每月支付9美金，優先存取更快速的 GPU 和 TPU。<br>
3共用功能：Colab筆記本是存在Google Drive，方便管理ipynb檔案，也可以將程式檔案ipynb下載分享給其他人使用。<br>
4開啟GitHub筆記本：透過開啟筆記本功能，可以點選GitHub選項，貼上你從GitHub看到的ipynb檔案網址，就可以在Google Colab開啟檔案或複製至自身的Google Drive。<br>
